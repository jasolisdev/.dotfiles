"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[472],{99922:(e,i,n)=>{n.d(i,{o:()=>t});var a=n(17231),l=n(44503);function t(){return{version:(0,a.W6)(l.GE)?2:1}}},80651:(e,i,n)=>{n.r(i),n.d(i,{Episode:()=>we,default:()=>Pe,parseReleaseDate:()=>Ue});var a=n(67294),l=n.n(a),t=n(65858),d=n(47886),o=n(20657),s=n(69518),r=n.n(s),m=n(62975),c=n(67154),u=n.n(c),k=n(28248),v=n(76343),p=n(28120),S=n(38470),N=n(74600),y=n(54280);const g=({uri:e,segmentCount:i})=>{const n=(0,y.G)(),t=(0,a.useCallback)((async(i,a)=>{const l=Math.ceil(i/2);try{return function(e,i,n){return e.reduce(((e,a,l)=>((l>0||i>0)&&e.push({type:"SPACER",id:`spacer-${e.length}`}),"MUSIC"===a.type?e.push(function(e,i,n){return{type:"MUSIC",index:i,uri:n.uri,episodeUri:e,start:n.start,stop:n.stop,duration:n.duration,name:n.track.name,artists:n.track.artists,album:n.track.album,playable:n.track.playable}}(n,l,a)):"TALK"===a.type&&e.push(function(e,i,n){return{type:"TALK",index:i,uri:e,title:n.title,subtitle:n.subtitle,start:n.start,stop:n.stop,duration:n.duration,showUri:n.show.uri,showName:n.show.name}}(n,l,a)),e)),[])}(await n.getSegments(e,l,a),l,e)}catch(e){return[]}}),[n,e]),d=(0,a.useCallback)((i=>{switch(i.type){case"SPACER":return l().createElement("div",{key:i.id,className:p.Z.spacerRow});case"MUSIC":return l().createElement(k.Z,u()({key:`${e}-${i.index}`},i));case"TALK":return l().createElement(N.t,u()({key:`${e}-${i.index}`},i));default:return(0,S.U)(i)}}),[e]),s=o.ag.get("music_and_talk.in_this_episode");return l().createElement("div",null,l().createElement(v.Dy,{as:"h2",variant:v.$e.canon,color:"var(--spice-text)",className:p.Z.header},s),l().createElement(k.Pv,{ariaLabel:s,hasHeaderRow:!0,rowPlaceholder:k.hU,columns:[k.QD.TITLE,k.QD.ALBUM_OR_SHOW,k.QD.DURATION],renderRow:d,fetchTracks:t,resolveUri:e=>"MUSIC"===e.type?e.uri:"",limit:50,nrTracks:2*i-1,testID:"music-and-talk-tracklist"}))};var F=n(44503),h=n(1663),E=n(37483);const b="__L02U6_1abVc6FFSAsC",f="IOWGhCKFM6fVmIZO8rvT",w="oNansDGSW2Z_KT8oTdXG",P="yEb8en0VQIAjxY6D9ZVx",U="uZQ7FbyLgNwVVV87jh98",D="Tw1hKrjBKfQ_pw0kniU1";var I=n(92408),C=n(56802),T=n(53424),A=n(20238),M=n(7073),R=n(20246),L=n(25988),_=n(95661),x=n(43620),V=n(18261),O=n(99922),B=n(74849);const K=(0,a.lazy)((()=>n.e(728).then(n.bind(n,42069))));function Z(e){const i=(0,B.m)(),n=(0,O.o)();return i?l().createElement(a.Suspense,{fallback:!0},l().createElement(K,u()({},n,e))):null}var Q=n(51871),W=n(11414),$=n(30947),q=n(17231),z=n(67892),G=n(84242),H=n(38894),Y=n(98984);const j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getEpisode"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"htmlDescription"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"externallyHosted"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"audioPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"playedState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playPositionMilliseconds"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"trailer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"Field",name:{kind:"Name",value:"showTypes"}}]}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}}]}},{kind:"Field",name:{kind:"Name",value:"segments"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"segments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}}]}}]}}]}}]}}]};var J=n(94184),X=n.n(J),ee=n(63897);const ie="q7KvJyPNHQxqqcteXJZ6",ne="thCvnIjyQcwDsBBgw13e",ae="HOnlboJODIHGa5lQQ_Un",le=({title:e,episodes:i,className:n})=>l().createElement("div",{className:X()(ie,n)},l().createElement(v.Dy,{as:"h2",variant:v.Dy.canon,className:ne},e),l().createElement("div",{className:ae},i.map((e=>l().createElement(ee.B,{key:e.id,entity:e}))))),te={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getRecommendedEpisodes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recommendedEpisodes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}}]}}]}}]}}]},de=({uri:e,limit:i})=>{var n;const{data:t}=(d={uri:e,limit:i},(0,Y.a)(te,d,s));var d,s;const r=(0,a.useMemo)((()=>{var e;return((null==t||null===(e=t.episode)||void 0===e?void 0:e.recommendedEpisodes.items)||[]).map((e=>{var i,n,a,l,t,d,o;return{id:e.episode.id,uri:e.episode.uri,name:e.episode.name,description:null!==(i=e.episode.description)&&void 0!==i?i:"",explicit:(null===(n=e.episode.contentRating)||void 0===n?void 0:n.label)===M.KS.Explicit,release_date:Ue(null===(a=e.episode.releaseDate)||void 0===a?void 0:a.isoString),duration_ms:e.episode.duration.totalMilliseconds,images:null!==(l=null===(t=e.episode.coverArt)||void 0===t?void 0:t.sources)&&void 0!==l?l:[],show:{images:null!==(d=null===(o=e.episode.podcast.coverArt)||void 0===o?void 0:o.sources)&&void 0!==d?d:[]}}}))}),[null==t||null===(n=t.episode)||void 0===n?void 0:n.recommendedEpisodes.items]);return(null==r?void 0:r.length)>0?l().createElement(le,{title:o.ag.get("mwp.entity.might.like"),episodes:r}):null};var oe=n(8341),se=n(62890),re=n(23716),me=n(5944),ce=n(30247),ue=n(70369),ke=n(34325),ve=n(57978),pe=n(84629),Se=n(84788),Ne=n(59482),ye=n(72907),ge=n(55911),Fe=n(72917),he=n(95806);const Ee="activation-trigger-mme",be=({episodeUri:e,showUri:i,isLocked:n,isPlaying:a,isPlayDisabled:d,playButtonPlayLabel:o,playButtonPauseLabel:s,onClick:m})=>{const c=(0,t.v9)((e=>{var i;return null===(i=e.platform)||void 0===i?void 0:i.isBrowser})),u=l().createElement(he.l,{showUri:i,enabled:n},l().createElement(ge.JM,{size:ge.qE.lg,onClick:m,isPlaying:a,disabled:d,locked:n,ariaPlayLabel:o,ariaPauseLabel:s}));return c?l().createElement(Fe.c,{id:Ee,targetURI:r().from(e)},u):u};function fe(e){const i=r().from(e);return`/show/${r().hexToId((null==i?void 0:i.id)||"")}`}const we=e=>{var i,n,s,c,u,k,p,S,N,y,O,B,K,J,X;const{uri:ee}=e,ie=(0,d.TH)(),ne=(0,t.I0)(),ae=(0,re.g)(),le=(0,C.o)(),te=(0,q.W6)(F.Cz),{data:ge}=(Fe={uri:ee},he={cacheTime:30*Y.y},(0,Y.a)(j,Fe,he));var Fe,he;const we=null==ge?void 0:ge.episode,[Pe,De]=(0,a.useState)((null==we?void 0:we.playedState.state)===M.sY.Completed),Ie=(0,q.W6)(F.Be),Ce=null==ge||null===(i=ge.episode)||void 0===i||null===(n=i.segments)||void 0===n||null===(s=n.segments)||void 0===s?void 0:s.totalCount,Te=void 0!==Ce&&Ce>0&&Ie,Ae=(0,H.g)(),{triggerPlay:Me,togglePlay:Re,isPlaying:Le,isActive:_e}=(0,G.n)({uri:ee},{featureIdentifier:"episode"}),xe=(0,oe.Y)((e=>{var i;return null!==(i=(0,me.k)(e))&&void 0!==i?i:void 0})),Ve=(0,oe.Y)((e=>{var i;return null!==(i=null==e?void 0:e.isPaused)&&void 0!==i?i:void 0})),Oe=null==we?void 0:we.type,Be=function(e,i,n,a,t){const d=i===M.Wf.Episode;return(0,ke.G3)(e,a,n,t)?l().createElement(ke.Fg,{isMusicAndTalk:d}):d?o.ag.get("type.showEpisode"):o.ag.get("type.podcastEpisode")}(ee,Oe||M.Wf.Unknown,null!==(c=null==we?void 0:we.playedState.playPositionMilliseconds)&&void 0!==c?c:0,Ue(null==we||null===(u=we.releaseDate)||void 0===u?void 0:u.isoString),(null==we?void 0:we.playedState.state)===M.sY.Completed),Ke=null==we||null===(k=we.coverArt)||void 0===k||null===(p=k.sources)||void 0===p||null===(S=p[0])||void 0===S?void 0:S.url,Ze=(0,x.Z)(Ke||null),Qe=(0,t.v9)((e=>{var i;return null===(i=e.platform)||void 0===i?void 0:i.isBrowser})),We=!(null!=we&&we.playability.playable)&&(null==we?void 0:we.playability.reason)===M.Ku.PaymentRequired,$e=(0,ce.s)(we,null==we?void 0:we.podcast),{badges:qe}=(0,Se.r)({contentRating:null==we||null===(N=we.contentRating)||void 0===N?void 0:N.label}),ze=(0,a.useCallback)((e=>{null!=we&&we.playability.playable||!qe.nineteen||(e.stopPropagation(),ne((0,pe.RM)((null==we?void 0:we.uri)||"")))}),[null==we?void 0:we.uri,null==we?void 0:we.playability.playable,qe.nineteen,ne]),Ge=(0,a.useCallback)(((e,i=!0)=>{if(We||!we)return;let n="play";!Le||0!==e&&i||(n="pause"),le({intent:n,targetUri:ee,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),Oe===M.Wf.Episode&&Qe?m.y.set((()=>({triggerId:Ee,triggerAction:null}))):_e&&!i?Ae?Ve?ae.resume():ae.pause():Re():Ae?$e({seekTo:e}):Me({seekTo:e})}),[We,we,Le,le,ee,Oe,Qe,_e,Ae,Ve,ae,Re,$e,Me]),He=(0,a.useCallback)((()=>{le({intent:"expand-description",type:"click"})}),[le]),Ye=(null==we?void 0:we.description)||te&&(null==we?void 0:we.htmlDescription);if((0,a.useEffect)((()=>{if(we){const e=new URLSearchParams(ie.search);if(e.has("t")){const i=e.get("t")||"0",n=1e3*parseInt(i,10);n<=we.duration.totalMilliseconds&&Ge(n)}}}),[we]),!we)return l().createElement(h.h,{errorMessage:o.ag.get("error.not_found.title.podcast")});const je=!We&&!we.playability.playable,Je=o.ag.get("tracklist.a11y.play",we.name,we.podcast.name),Xe=o.ag.get("tracklist.a11y.pause",we.name,we.podcast.name),ei=we.podcast.uri,ii=null===(y=r().from(ei))||void 0===y?void 0:y.toURLPath(!0);return l().createElement("section",{"data-testid":"episode",className:b},l().createElement(ue.$,null,o.ag.get("podcasts.episode.seo.title",{name:we.name,show:null!==(O=null===(B=we.podcast)||void 0===B?void 0:B.name)&&void 0!==O?O:""})),l().createElement(T.gF,{backgroundColor:Ze},l().createElement(Ne.W,null,l().createElement(ye.i,{text:we.name,dragUri:ee,dragLabel:we.name})),l().createElement("div",{className:D},l().createElement(V._,{menu:l().createElement(L.k,{uri:ee,sharingInfo:we.sharingInfo,showUri:ei,contextUri:ee,isPlayed:Pe,onMarkAsPlayed:De})},l().createElement(T.Oe,{loading:"eager",name:we.name,images:(null===(K=we.coverArt)||void 0===K?void 0:K.sources)||[],placeholderType:"episode",shape:T.Kc.ROUNDED_CORNERS}))),l().createElement(T.sP,null,l().createElement(T.dy,{small:!0,uppercase:!0},Be),l().createElement(V._,{menu:l().createElement(L.k,{uri:ee,sharingInfo:we.sharingInfo,showUri:ei,contextUri:ee,isPlayed:Pe,onMarkAsPlayed:De})},l().createElement(T.xd,{dragUri:ee,dragLabel:we.name},l().createElement("span",{"data-testid":"episodeTitle"},we.name))),l().createElement(V._,{menu:l().createElement(L.k,{uri:ee,sharingInfo:we.sharingInfo,showUri:ei,contextUri:ee,isPlayed:Pe,onMarkAsPlayed:De})},l().createElement(z.Z,{to:fe(ei)},l().createElement(T.dy,{large:!0,bold:!0},l().createElement("span",{"data-testid":"showTitle"},we.podcast.name)))))),l().createElement($.o,{backgroundColor:Ze},l().createElement($.F,null,qe.nineteen&&l().createElement(ve.X,{className:U,size:16}),l().createElement(I.E,{size:I.$.LARGE,fullyPlayed:Pe,durationMs:we.duration.totalMilliseconds,releaseDate:Ue(null===(J=we.releaseDate)||void 0===J?void 0:J.isoString),resumePositionMs:null!==(X=we.playedState.playPositionMilliseconds)&&void 0!==X?X:0,isPlaying:Le,position:_e&&xe||void 0})),l().createElement($.F,null,l().createElement("div",{onClick:ze},l().createElement(be,{episodeUri:ee,showUri:ei,isLocked:We,onClick:()=>{var e;Ge(null!==(e=we.playedState.playPositionMilliseconds)&&void 0!==e?e:0,!1)},isPlaying:Le,isPlayDisabled:je,playButtonPlayLabel:Je,playButtonPauseLabel:Xe})),!We&&l().createElement(E.p,{uri:we.uri,showUri:ei}),l().createElement(Q.w,{uri:we.uri,size:W.q.md}),l().createElement(R.y,{menu:l().createElement(L.k,{uri:ee,sharingInfo:we.sharingInfo,showUri:ei,contextUri:ee,isPlayed:Pe,onMarkAsPlayed:De})},l().createElement(_.z,{label:o.ag.get("more.label.context",we.name)})))),l().createElement("div",{className:"contentSpacing"},Ye&&l().createElement(l().Fragment,null,l().createElement(v.Dy,{as:"h2",variant:v.$e.canon,color:"var(--spice-text)",className:w},o.ag.get("episode.description-title")),l().createElement(A.o,{className:f,onTimeStampClick:Ge,maxLines:4,onExpanded:He,content:(we.description||"").trim(),htmlContent:te&&we.htmlDescription?we.htmlDescription:void 0,LinkComponent:z.Z,enableTimestamps:we.playability.playable})),Te&&l().createElement(g,{segmentCount:Ce||0,uri:ee}),ii&&l().createElement(se.z,{version:"outlined",linkTo:ii,className:P},o.ag.get("episode.see_all_episodes")),l().createElement(Z,e),l().createElement(de,{uri:ee,limit:6})))},Pe=l().memo((()=>{const{episodeId:e}=(0,d.UO)(),i=r().episodeURI(e).toURI();return l().createElement(a.Suspense,{fallback:null},l().createElement(we,{uri:i,key:i}))}));function Ue(e){return(null==e?void 0:e.replace(/T.*/,""))||""}}}]);
//# sourceMappingURL=xpui-routes-episode.js.map